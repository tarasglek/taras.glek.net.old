
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Pork, MCPP, Oink and Elsa...What's going on? - All About Performance</title>
  <meta name="author" content="Taras Glek">

  
  <meta name="description" content="It seems that there is some confusion as to what pork is and how it&#8217;s related to oink and elsa. So here is my view of it. Pork is my set of &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://taras.glek.net/blog/2008/07/18/pork-mcpp-oink-and-elsawhats-going-on/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="All About Performance" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">All RSS</a></li>
  
  <li><a href="/mozilla.xml"  title="subscribe via RSS">Mozilla RSS</a></li>
</ul>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <header role="banner"><hgroup>
  <h1><a href="/">All About Performance</a></h1>
  
    <h2>and other stuff by Taras Glek</h2>
  
</hgroup>

</header>
  <div id="main">
    <div id="content">
      <div>
<article class="hentry" role="article">
  
  <header>
    
      <h1 class="entry-title">Pork, MCPP, Oink and Elsa...What's Going On?</h1>
    
    
      <p class="meta">
        








  


<time datetime="2008-07-18T03:29:28-07:00" pubdate data-updated="true">Jul 18<span>th</span>, 2008</time>
        
      </p>
    
  </header>


<div class="entry-content"><p>It seems that there is some confusion as to what pork is and how it&#8217;s related to oink and elsa. So here is my view of it.</p>

<p><a href="http://developer.mozilla.org/en/docs/Pork"><strong>Pork</strong></a> is my set of tools that use Elsa to rewrite sourcecode (mainly Mozilla code). Our use of Pork is solely for rewriting as it is not suited for <a href="http://developer.mozilla.org/en/docs/Dehydra">convenient</a> and <a href="http://developer.mozilla.org/en/docs/Treehydra">hardcore</a> analysis needs as much as the GCC based tools are.</p>

<p><a href="http://mcpp.sf.net/">MCPP</a> is the secret sauce C preprocessor that makes C++ rewriting with Elsa possible by annotating preprocessed files with information to undo the lexical braindamage resulting from macro expansion.</p>

<p><strong>Elsa</strong> is a awesome C++ parser. Awesome in that is can preserve more information regarding parsed code than any other C/C++ parser and it is easy to extend.</p>

<p>We maintain our own version of Elsa within pork.</p>

<p>I think our version of Elsa is the most up to date and most compatible with newer C++ features and headers used by newer GCC releases. We encourage other projects with C++ parsing/rewriting needs to collaborate with us. We will be parsing code with Elsa for a few years to come and it&#8217;s a lot of work to maintain a C++ parser by a single entity. I think elsa is a much better backend to build refactoring support onto than any other C++ parsing project out there right now.</p>

<p><strong>The Messy Details</strong></p>

<p>Now lets move on the more confusing parts: oink, oink-stack, and the oink mailing list.</p>

<p><a href="http://www.cubewano.org/oink"><strong>oink</strong></a> consists of some static analysis tools and was meant to be a central place where all of the Elsa and Elsa-related development was supposed to happen. When people refer to oink, they usually mean the oink-stack which is a subversion meta repository that pulls in a dozen of subrepositoes(smbase, elkhound, elsa, oink(where static analysis tools live), etc).</p>

<p>So when I started working on refactoring tools I was told that I should aim to have my tools added to oink, but there were some legal hassles to work out in the meantime so I cloned the oink-stack and developed my tools with minimal changes to oink-stack. This included various elsa extensions, bugfixes, etc.</p>

<p>However, the little momentum that oink had has fizzled out due to various personality conflicts and various academics loosing interest. The code has been bitrotting for as long as I&#8217;ve been working at Mozilla.</p>

<p>So the end result of oink is that we have pork which is a superset of oink. I&#8217;m not even sure if I mention the name pork anywhere in the sources. So pork at the moment means &#8220;Taras&#8217; continuation and extension of oink&#8221;. I am using the <a href="http://www.cubewano.org/lists/listinfo/oink-devel">oink mailing list</a> for any discussion on changes to Elsa/etc in hopes that at least some of the genius lurkers there will regain their interest in elsa.</p>

<p><strong>Where do We Go From Here?</strong></p>

<p>Onward! Due to the original authors vision of what C++ is and the state of C++ at the time Elsa was conceived, current pork code causes people to have many WTF moments (followed by banging head against keyboard) when they first start using it.</p>

<p>The short version of my plan is:</p>

<ul>
<li>allow one to do &#8220;using namespace std&#8221; when using elsa</li>
<li>Restructure pork repositories such that there are only 3 of them rather than 11 (elsa, elkhound, pork)</li>
<li>get rid of the oink repository (those tools do not work for us)</li>
<li>Make pork only consist of just my tools (with a sane build system) rather than be mixed into unmainted oink stuff</li>
<li>Make pork compile with new compilers (GCC 4.3 and recent MSVC++)</li>
<li>Keep track of this in a <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=438061">bug</a></li>
<li>Clean up various misc things
Some of you might ask &#8220;But Taras, why now, why not just keep doing what you&#8217;ve been doing?&#8221;. I was doing what I was doing because I had an overwhelming goal of devising a way to automate static analysis and refactoring of Mozilla on my shoulders and I wasn&#8217;t convinced that it was feasible. I had to learn to split my time between tool development and actually using the tools. Naturally I cut corners on tool development :)</li>
</ul>


<p>Since then slowly, but surely various awesome hackers have started doing rewrites and analyses themselves freeing me up to focus more on development. To make matters sweeter, various hackers have started submitting bugreports, fixes, ports to my tools. This gives me more time to focus on the big picture.</p>

<p>Finally, I belive that automation of the sort we are doing at Mozilla is something that has been missing from open source development practices and it will catch on once people realize what they&#8217;ve been missing. Reducing those WTF moments will help people think positively.</p>

<p><strong>Update:</strong></p>

<p><em>Why three repositories instead of one?</em></p>

<ol>
<li>The three will be elkhound, elsa, pork</li>
<li>elkhound is useful on it&#8217;s own</li>
<li>elsa is too and other elsa users are likely to not care about Mozilla&#8217;s rewriting tools
<em>I__s oink really dead?</em></li>
</ol>


<p>Yes. The maintainers have moved on to other projects. When they were maintaining oink, outside contributors couldn&#8217;t get their code upstream.</p>
</div>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Taras Glek</span></span>

      








  


<time datetime="2008-07-18T03:29:28-07:00" pubdate data-updated="true">Jul 18<span>th</span>, 2008</time>
      

<span class="categories">
  
    <a class='category' href='/blog/categories/mozilla/'>mozilla</a>, <a class='category' href='/blog/categories/pork/'>pork</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://taras.glek.net/blog/2008/07/18/pork-mcpp-oink-and-elsawhats-going-on/" data-via="tarasglek" data-counturl="http://taras.glek.net/blog/2008/07/18/pork-mcpp-oink-and-elsawhats-going-on/" >Tweet</a>
  
  
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/blog/2008/07/09/static-analysis-and-refactoring-tooling-updates/" title="Previous Post: Static Analysis and Refactoring Tooling Updates">&laquo; Static Analysis and Refactoring Tooling Updates</a>
      
      
        <a class="basic-alignment right" href="/blog/2008/07/22/dogfooding-pork-oscon/" title="Next Post: Dogfooding pork & OSCON">Dogfooding pork & OSCON &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>

<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2012/12/24/making-pages-load-faster/">Making pages load faster</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/12/21/interesting-bugzilla-activity/">Snappy #45: The view from home</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/12/17/hello-octopress/">Hello Octopress</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/11/26/coping-with-flash-hangs/">Coping with Flash hangs</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/11/16/snappy-44-fixing-tab-switching-in-vancouver/">Snappy #44: Fixing tab switching in Vancouver</a>
      </li>
    
  </ul>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating...</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("tarasglek", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/tarasglek" class="twitter-follow-button" data-show-count="false">Follow @tarasglek</a>
  
</section>





  
</aside>


    </div>
  </div>
  <footer role="contentinfo"><p><h6>
  Copyright &copy; 2012 - Taras Glek - content on this site is licensed under the
Creative Commons Attribution Share-Alike License v3.0 or any later version.

  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span></h6>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'allaboutperformance-tarasglek';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://taras.glek.net/blog/2008/07/18/pork-mcpp-oink-and-elsawhats-going-on/';
        var disqus_url = 'http://taras.glek.net/blog/2008/07/18/pork-mcpp-oink-and-elsawhats-going-on/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
