
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>All About Performance</title>
  <meta name="author" content="Taras Glek">

  
  <meta name="description" content="Hunting Down Mythical &#8220;Slowness&#8221; I recently met a developer who used Chromium instead of Firefox. Chromium&#8217;s superior startup speed &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://taras.glek.net/blog/page/13/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="All About Performance" type="application/atom+xml">
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  

</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">All About Performance</a></h1>
  
    <h2>and other stuff by Taras Glek</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:taras.glek.net" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/01/19/chromium-vs-minefield-cold-startup-performance-comparison/">Chromium vs Minefield: Cold Startup Performance Comparison</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-01-19T09:05:28-08:00" pubdate data-updated="true">Jan 19<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><strong>Hunting Down Mythical &#8220;Slowness&#8221;</strong></p>

<p>I recently met a developer who used Chromium instead of Firefox. Chromium&#8217;s superior startup speed was his reason for using it.This got me excited because said developer was running Linux, so it was relatively easy to measure cold startup and get a complete <a href="http://taras.glek.net/blog/2009/10/23/studying-library-io-systemtap-style/">IO breakdown</a>.</p>

<p>Turned out Firefox took roughly 23 seconds to start. After much cursing about how I&#8217;ve never seen Firefox startup this slow, I eventually gave up on figuring out what&#8217;s slowing his startup and instead we measured Chromium startup. It also turned out to also be roughly 23 seconds. The super-slow hard drive made everything slow. Turned out Chromium&#8217;s superior startup was a myth in this case.</p>

<p><strong>Measuring Startup</strong></p>

<p>As a result of investigating the startup myth above, my kiwi coworkers encouraged me to post a comparison of Chrome/Firefox startup. I am at <a href="http://www.lca2010.org.nz/">linuxconf</a> at the moment so I did the comparison on my laptop.</p>

<p>Laptop configuration:</p>

<ul>
<li>Intel(R) Core(TM)2 Duo CPU  L9400 running at 800Mhz to amplify any performance differences.</li>
<li>HITACHI HTS722020K9SA00 harddrive for the user profile and browser binaries</li>
<li>OCZ Vertex 30GB SSD for system libraries/configuration.</li>
<li>Fedora 12, Minefield 20100119 tarball, chromium-4.0.285.0-0.1.20091230svn35370.fc12.i686</li>
<li>sudo sync &amp;&amp; sudo sysctl -w vm.drop_caches=3 &amp;&amp; sudo sysctl -w vm.drop_caches=0 to clear the disk cache inbetween runs
What am I testing? I am measuring the time between invoking the browser until a JavaScript snippet embedded within a basic webpage is executed (ie <a href="http://blog.vlad1.com/2009/07/28/measuring-startup/">Vlad&#8217;s approach</a>, with a slightly modified <a href="http://people.mozilla.com/~tglek/startup/startup.html">startup.html</a>). The above sysctl command clears disk caches, this creates a similar situation to when one turns on the computer and it hasn&#8217;t yet loaded all of the browser libraries from disk into memory. This is a blackbox approach to measuring how long it takes from clicking on the browser icon to get an interactive browser.</li>
</ul>


<p>Firefox commandline: firefox -profile /mnt/startup/profile/firefox  -no-remote file://<code>pwd</code>/startup.html#<code>python -c 'import time; print int(time.time() * 1000);'</code></p>

<p>Chromium commandline: chromium-browser &#8211;user-data-dir=/mnt/startup/profile/chrome  file://<code>pwd</code>/startup.html#<code>python -c 'import time; print int(time.time() * 1000);'</code></p>

<p>Both of these tests are done with an empty profile that was populated and has settled after running the browser a few times.</p>

<p><strong>Results</strong></p>

<p>The following numbers are milliseconds reported by the startup.html above.</p>

<p>Running Chromium five times: 4685, 4168, 4222, 4197, 4232</p>

<p>Running Minefield five times: 3155, 3273, 3352, 3311, 3322</p>

<p>I picked Minefield because that&#8217;s the browser that I run and the codebase that I focus on. The linux Chromium channel seems to be the closest parallel to Minefield. I did not test on Windows because it is a bit of a <a href="http://taras.glek.net/blog/2010/01/04/windows-7-startup-exploration/">nightmare</a> to measure cold startup there.</p>

<p><strong>Conclusion</strong></p>

<p>On my system Minefield is around 30% faster at starting up with  an empty profile than Chromium (the difference is amplified by running the CPU at 800Mhz). For comparison of Minefield against older Firefox versions, see <a href="http://autonome.wordpress.com/2009/11/21/firefox-startup-performance-weekly-summary-11/">Dietrich&#8217;s post</a>.</p>

<p>I suspect that there is a relatively small difference between the two browsers because we are running into the fundamental limitations of loading large applications into memory (<a href="http://taras.glek.net/blog/2009/10/20/large-apps-just-have-to-start-slow/">my rant</a>).</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/01/04/some-developers-manually-grope-around-in-the-dark/">Some Developers Manually Grope Around in the Dark</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-01-04T12:27:03-08:00" pubdate data-updated="true">Jan 4<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Cool thing about static analysis is that you can ask painful-for-humans questions about your codebase AND have them answered. Here are two that got answered by Ehren:</p>

<p>Where do function bodies continue after return statements (ie obviously dead/broken code)? <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=535646">Bug 535646</a>.</p>

<p>How many functions in Mozilla could/should be marked static? <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=536427">Bug 536427</a>.</p>

<p>Awesome!</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/01/04/windows-7-startup-exploration/">Windows 7 Startup Exploration</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-01-04T03:28:49-08:00" pubdate data-updated="true">Jan 4<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I did some digging to figure out if one can setup cold-startup testing in Windows 7 without nasty hacks. My conclusion is: sorta-kinda.</p>

<p><strong>The Good - Most of the Ingredients Are Present </strong></p>

<p>I haven&#8217;t actively used Windows since pre-XP days. It looks like it has come a long way since then: there is now a decent interactive shell, all kinds of settings/services can be controlled from the commandline and there is even sudo-like functionality.</p>

<p>PowerShell takes inspiration from the korn shell and throws in .net which allows for much nicer &#8220;shell programming&#8221; than the dominant bash shell.</p>

<p>mountvol is a terrible equivalent to mount in linux - but it exists, so I&#8217;m happy.</p>

<p>NTFS junctions are frustrating equivalents to links in a unix filesystem.</p>

<p><strong>The Bad</strong></p>

<p>The essential ability to completely flush filesystem caches isn&#8217;t there. This isn&#8217;t quite as embarrassing as it seems as Mac OS X&#8217;s purge command does not flush the page cache (resulting in mmapped files not purged from cache), so technically OS X has the same limitation and only Linux gets it right.</p>

<p><strong>The Ugly Workaround</strong></p>

<p>After much brainstorming we figured out that we can clear all relevant caches on Mac OS X by putting files that we care about on a separate partition and mounting/unmounting it for every measurement.</p>

<p>Ridiculously, Windows is &#8220;smarter&#8221; than that and appears to cache stuff per-drive, such that mounting/unmounting a partition has no effect on the cache. The best workaround I could come up with involves putting the said partition onto a USB disk and unplugging it in-between unmount/mount testing cycle.</p>

<p><strong>Windows 7 Startup Recipe</strong></p>

<p>1) Set up junctions for the 2 profile directories to point to the USB partition, unzip firefox onto that partition.</p>

<p>2)</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>$old = (get-location)
</span><span class='line'>$mountpoint = $env:userprofile + "\cold"
</span><span class='line'># magic name given by running mountvol
</span><span class='line'>$drive = "\\?\Volume{885d5bc3-e918-11de-a4e5-002268e3077c}\"
</span><span class='line'># Based on http://poshcode.org/696 + fiddling with UAC settings to avoid prompts
</span><span class='line'>sudo mountvol $mountpoint $drive
</span><span class='line'># Mountvol doesn't seem to block until drive is mounted
</span><span class='line'>sleep 1
</span><span class='line'>#mountvol
</span><span class='line'>cd $mountpoint\firefox
</span><span class='line'>echo (pwd)
</span><span class='line'># The following command shows PowerShell awesomeness
</span><span class='line'># based on [Vlad's approach](http://blog.vlad1.com/2009/07/28/measuring-startup/)
</span><span class='line'>./firefox.exe -no-remote "file://$(pwd)\startup.html#$([Int64](([DateTime]::utcnow - (new-object DateTime 1970,1,1)).ticks/10000))"
</span><span class='line'>cd $old
</span><span class='line'># I haven't yet figured out how to wait on firefox.exe to finish
</span><span class='line'>sleep 10
</span><span class='line'>sudo mountvol $mountpoint /d</span></code></pre></td></tr></table></div></figure>


<p>3) Unplug USB drive</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/12/17/javascript-dom/">JavaScript DOM</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-12-17T07:43:01-08:00" pubdate data-updated="true">Dec 17<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I filed<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=533874"> bug 533874</a> to expose the JavaScript AST to JS, but turns out I need to explain why it&#8217;s important to expose the JavaScript AST. So lets start from the beginning.</p>

<p>My name is Taras and I like to wrestle useful information out of tools that do not think to offer it. I firmly believe that writing/maintaining code is more difficult than it should be. I think the current organization of compilers is partially responsible for it.</p>

<p><strong>Related Prior Work </strong>Some groups at Mozilla have realized that inspection and refactoring of code are tasks that will often consume as many people as can be thrown at it so there has to be a better way. That better way is through tools: get computers to do things that are difficult for humans. We do that a lot for other kinds of tasks, but not so much for computers. For example, when was the last something you googled something using telnet? Yet our tools for presenting and analyzing code are about as sophisticated as telnet. For some reason it is easier to find some random piece of information on the web than it is to find what code implements a function that is being called from my code.</p>

<p>As the original author, I think <a href="https://developer.mozilla.org/En/Dehydra">Dehydra</a>, <a href="https://developer.mozilla.org/en/Treehydra">Treehydra</a> on top of the GCC plugin <a href="http://gcc.gnu.org/wiki/GCC_PluginAPI">API</a> give us a pretty reasonable way to extract useful information out of our C++ code. I feel lost and confused without Dave&#8217;s <a href="http://australia.proximity.on.ca/dxr/">DXR</a>, the JS team routinely breaks (and fixes) invariants in the JS engine and we&#8217;ve been able to wipe out certain classes of bugs (ie code patterns that cause them) mozilla-wide. I&#8217;m looking forward to reducing the footprint of Mozilla by deleting <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=457262">more</a> dead code.</p>

<p><strong>JavaScript Needs</strong> My efforts so far have focused on C++ because it is finicky language and developers need all the help they can get with it. I think we need to the same thing for JavaScript. I think there is a lot of useful information in JavaScript code that is burried and hard to get to. <a href="http://quetzalcoatal.blogspot.com/">Joshua Cranmer</a> broke new ground in building <a href="https://developer.mozilla.org/en/JSHydra">JSHydra</a> on top of SpiderMonkey. This way one can parse JavaScript in exact same way as Spidermonkey sees it (something that can only be approximated with other approaches). I think we should offer the ability to analyze js code within Spidermonkey. Unfortunately, he is a busy student so he doesn&#8217;t have the time to develop JSHydra this to the next level. <strong> How Would JavaScript Developers Benefit?</strong> Currently we have jshydra deployed on AMO to scan javascript for potential issues to make the reviewer&#8217;s job more productive. Dave Humphrey is working away on integrating JSHydra into DXR so we can have semantic navigation of JavaScript: what components are implemented JavaScript, wouldn&#8217;t it be nice to know who calls certain methods(including javascript callsites), etc. Gandalf has a cool idea where he needs to be able to extract translatable strings out of JetPacks. I believe JetPack people in general would like to be able to analyze JS code more.</p>

<p>I think it&#8217;s clear that the common trend in all these tasks is to turn an opaque text blob into something that can be easily navigated programatically. Wouldn&#8217;t it suck to not to be able to walk the DOM for HTML? Why is it ok to accept that handicap for the essense of all programs?</p>

<p><strong>How Should This Be Solved?</strong> I don&#8217;t know for sure, but my friend Jim Blandy, came up with a good suggestion. We already have eval/uneval in SpiderMonkey. it would be really cool to extend uneval to produce a iteratable data structure instead of a text blob. So I filed a <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=533874">bug 533874</a> on this, and this my explanation of why I think that would be a very empowering feature to expose ASTs in JavaScript.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/11/20/dehydra-testsuite-passes-on-gcc-4-5/">Dehydra Testsuite Passes on GCC 4.5</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-11-20T08:24:04-08:00" pubdate data-updated="true">Nov 20<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I spent couple of days fixing the remaining test-suite failures on GCC 4.5 trunk for <a href="https://developer.mozilla.org/En/Dehydra">Dehydra</a>. Since the last time I looked into this, GCC went from crashing all over the place to only crashing if I did something bad. It was nice to discover that as a result of switching to 4.5 Dehydra users will get saner .isExplicit behavior and more precise location info.</p>

<p>Treehydra will take more work due to me <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=510190">misunderstanding</a> GTY annotations.</p>

<p>By the way, I am really grateful for all of the people who contributed GCC 4.5 fixes so far. You guys have been a big help in getting Dehydra testsuite to 100% on 4.5. Looks like I will meet my goals to finish De+Treehydra by the end of the year in time for GCC 4.5 release and my &#8220;Introducing Dehydra to the Developer World&#8221;-type talk at <a href="http://www.lca2010.org.nz/programme/schedule/view_talk/50151?day=thursday">LinuxConf.au.nz 2010</a>.</p>

<p><strong>Startup</strong> I reduced my focus on startup speed at the moment to catch up on Dehydra. I plan to work on reducing xpconnect overhead during startup next, ie more of <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=512584">this bug</a>.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/11/06/fsoss-dehydra-update/">FSOSS & Dehydra Update</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-11-06T09:27:53-08:00" pubdate data-updated="true">Nov 6<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Last week I was in Canada to present at <a href="http://fsoss.senecac.on.ca/2009/">FSOSS</a> with <a href="http://vocamus.net/dave/">David Humphrey</a> on awesome Mozilla Tools: Dehydra, DXR, Pork, etc. I think we managed to convey the message regarding what a sad affair that current developer development tools are.</p>

<p><strong>General-Purpose Dehydra Scripts</strong></p>

<p>Dehydra grew out of Mozilla&#8217;s constant need to figure out what is going on in the source code. As a result most of our scripts are very Mozilla API-specific. This makes harder for people outside of Mozilla to learn Dehydra. There is no library of Dehydra code that one can just plugin to start analyzing their codebase. Instead one has to sit down, figure out what Dehydra is capable of and then see if any of the problems facing the developer can be solved this way. If anyone wants to contribute such a library, let me know.</p>

<p>In the meantime, more general-purpose analyses are surfacing.</p>

<p><strong>Shadowed Members</strong></p>

<p>My favourite script so far is the member-shadowing checker. I ran into a member-shadowing warning that is unique to Sun&#8217;s C++ compiler. It was triggered by some code that I just landed on the tree. I fixed the warning, but within a few days a coworker ran into a bug caused by that member shadowing(due to having an unlucky revision of the code). The following example shows how simple it was to implement the warning in GCC/Dehydra.</p>

<p>See <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=522776">bug 522776</a> for the complete story on adding the member shadowing check to Mozilla.</p>

<p><strong>Printf</strong> Another general purpose analysis was done outside of Mozilla by Philip Taylor for <a href="http://os.wildfiregames.com/">his game</a>. His <a href="http://svn.wildfiregames.com/public/ps/trunk/build/dehydra/printf-type-check.js">script</a> checks wide printf format strings (which are overlooked by gcc). Independently, Benjamin wrote a printf checker for Mozilla printf-like code, see <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=493996">bug 493996</a>.</p>

<p><strong>Custom Sections in Object Files</strong> We have long speculated about how nice it would be if Dehydra could emit info into object files that could then be yanked out of the resulting binary (by say, valgrind). <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=523435">bug 523435</a> will soon make that a reality.</p>

<p><strong>Update:</strong> <a href="http://www.flickr.com/photos/mhoye/4058902208/in/photostream/">Two</a> <a href="http://www.flickr.com/photos/mhoye/4058902456/sizes/l/in/photostream/">photos</a> from FSOSS.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/10/23/studying-library-io-systemtap-style/">Studying Library IO - SystemTap Style</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-10-23T09:25:39-07:00" pubdate data-updated="true">Oct 23<span>rd</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>In my last blog <a href="http://taras.glek.net/blog/2009/10/20/large-apps-just-have-to-start-slow/">post</a> I expressed frustation with slowness induced by library IO. Then I went on a mission to measure it. I have been wanting to this for a while, but I figured that only DTrace can get this info without recompiling my kernel. So I tried to build Mozilla under Slowlaris (but the linker got up to 3GB and then set there swapping, ensuring that the nickname is justified). Then I fired up DTrace on the mini, but ran screaming because it seemed like fbt DTrace provider refused to let me dereference structs (later Joel told me that I&#8217;m supposed to copy data explicitly <a href="http://blogs.sun.com/timf/entry/dtrace_saves_the_day_again">like here</a>).</p>

<p>But while googling for a fbt workaround, I stumbled upon a DTrace/SystemTap comparision wiki. <a href="http://sourceware.org/systemtap/wiki">SystemTap</a>? The DTrace knockoff I have been hearing about? It works? This was a lightbulb moment where I realized that Linux was about to provide me with more information than I thought was possible.</p>

<p>So here is the data I got out of it:</p>

<p>Writing scripts in systemtap felt really natural after I figured out that pointers are to be dereferenced as arrays and what some of the error messages really meant. In the script I watch vfs_read() for io done via read() syscall, but it turns out that mmap() io actually happens via readahead. Here is the systemtap <a href="http://people.mozilla.com/~tglek/kernelio.stp">script</a>. I believe I accounted for all io. ext4_get_block (which seems to be the main function ext4 reads file data with) did not spend any time outside of that called by the functions I was tapping into.</p>

<p>I haven&#8217;t had much time to draw too many conclusions out of the data, posting it as an example of systemtap use. libxul accounts for most io both in terms of bytes and time spent. We&#8217;ll be fixing that, not yet sure as to what strategy to employ for the rest of the libraries.</p>

<p>SELECT file, sum(size) as bytesread, sum(time)/1000 as ms from startup  group by file order by bytesread desc ;</p>

<pre><code>file                                   | bytesread | ms
-------------------------------------------------------------------------+-----------+-----
/home/taras/firefox/libxul.so/                                          |  19530240 | 103
/usr/lib/libgtk-x11-2.0.so.0.1800.2/                                    |   3277312 |  15
/home/taras/firefox/chrome/toolkit.jar/                                 |   2097152 |   8
/home/taras/firefox/libmozjs.so/                                        |   1835520 |  36
/home/taras/.mozilla/firefox/imph4tsg.default/XPC.mfasl/                |   1671168 |   3
/home/taras/firefox/chrome/browser.jar/                                 |   1572864 |   5
/usr/share/icons/gnome/icon-theme.cache/                                |   1441792 |   7
/home/taras/firefox/libnss3.so/                                         |   1311232 |  18
/usr/lib/libX11.so.6.3.0/                                               |   1049088 |   5
/home/taras/.mozilla/firefox/imph4tsg.default/XUL.mfasl/                |    995328 |   2
/usr/lib/libgnomeui-2.so.0.2400.1/                                      |    918016 |   3
/usr/lib/libfreetype.so.6.3.20/                                         |    786944 |   3
/home/taras/firefox/libsqlite3.so/                                      |    655872 |  10
/usr/lib/libgconf-2.so.4.1.5/                                           |    655872 |   1
/usr/lib/libbonoboui-2.so.0.0.0/                                        |    655872 |   2
/usr/lib/libgdk-x11-2.0.so.0.1800.2/                                    |    655872 |   2
/usr/lib/libcrypto.so.1.0.0/                                            |    655872 |   2
/home/taras/firefox/chrome/en-US.jar/                                   |    655360 |   2
/usr/lib/libORBit-2.so.0.1.0/                                           |    524800 |   2
/lib/libasound.so.2.0.0/                                                |    524800 |  18
/home/taras/firefox/libnspr4.so/                                        |    524800 |  17
/usr/lib/libxml2.so.2.7.5/                                              |    524800 |   1
/usr/lib/libbonobo-activation.so.4.0.0/                                 |    524800 |   1
/usr/lib/libgnomecanvas-2.so.0.2600.0/                                  |    524800 |   1
/usr/lib/libXt.so.6.0.0/                                                |    524800 |  14
/lib/libgssapi_krb5.so.2.2/                                             |    524800 |   1
/usr/lib/libatk-1.0.so.0.2809.1/                                        |    524800 |   2
/home/taras/firefox/libnssckbi.so/                                      |    524800 |   6
/usr/lib/libbonobo-2.so.0.0.0/                                          |    524800 |   1
/usr/lib/libgnomevfs-2.so.0.2400.2/                                     |    524800 |   2
/home/taras/firefox/libsmime3.so/                                       |    393728 |  15
/usr/lib/libart_lgpl_2.so.2.3.20/                                       |    393728 |   1
/usr/lib/libvorbis.so.0.4.3/                                            |    393728 |   1
/home/taras/firefox/components/libbrowsercomps.so/                      |    393728 |  12
/lib/libresolv-2.10.90.so/                                              |    393728 |   0
/home/taras/firefox/libnssdbm3.so/                                      |    393728 |  15
/home/taras/firefox/libfreebl3.so/                                      |    393728 |  13
/home/taras/firefox/libssl3.so/                                         |    393728 |   8
/usr/lib/libssl.so.1.0.0/                                               |    393728 |   1
/lib/libkrb5.so.3.3/                                                    |    393728 |  24
/lib/libglib-2.0.so.0.2200.2/                                           |    393728 |   1
/usr/share/fonts/dejavu/DejaVuSans.ttf/                                 |    393216 |   1
/home/taras/firefox/components/browser.xpt/                             |    378141 |   6
/usr/lib/gtk-2.0/2.10.0/engines/libclearlooks.so/                       |    262656 |   1
/lib/libexpat.so.1.5.2/                                                 |    262656 |   1
/usr/lib/libfontconfig.so.1.4.3/                                        |    262656 |   0
/home/taras/firefox/components/libimgicon.so/                           |    262656 |   1
/lib/libkeyutils-1.2.so/                                                |    262656 |   0
/usr/lib/libgnome-keyring.so.0.1.1/                                     |    262656 |   1
/usr/lib/libgnome-2.so.0.2800.0/                                        |    262656 |   0
/usr/lib/libXau.so.6.0.0/                                               |    262656 |   0
/usr/lib/libXinerama.so.1.0.0/                                          |    262656 |   0
/usr/lib/libXdamage.so.1.1.0/                                           |    262656 |   0
/usr/lib/libXcomposite.so.1.0.0/                                        |    262656 |   0
/usr/lib/libfam.so.0.0.0/                                               |    262656 |  22
/home/taras/firefox/components/libdbusservice.so/                       |    262656 |  12
/home/taras/firefox/components/libmozgnome.so/                          |    262656 |  11
/usr/lib/libICE.so.6.3.0/                                               |    262656 |   1
/home/taras/firefox/libnssutil3.so/                                     |    262656 |  22
/usr/lib/libpangoft2-1.0.so.0.2600.0/                                   |    262656 |   0
/lib/libk5crypto.so.3.1/                                                |    262656 |   1
/home/taras/firefox/components/libbrowserdirprovider.so/                |    262656 |   9
/home/taras/firefox/libsoftokn3.so/                                     |    262656 |  10
/usr/lib/libxcb.so.1.1.0/                                               |    262656 |   1
/home/taras/firefox/components/libnkgnomevfs.so/                        |    262656 |  14
/home/taras/firefox/firefox-bin/                                        |    262547 |  13
/usr/share/fonts/dejavu/DejaVuSerif.ttf/                                |    262144 |   0
/home/taras/.mozilla/firefox/imph4tsg.default/compreg.dat/              |    147563 |   0
/usr/share/X11/locale/locale.alias/                                     |    134322 |  18
/lib/libc-2.10.90.so/                                                   |    132608 |   1
/lib/libtinfo.so.5.7/                                                   |    132096 |   0
/usr/lib/gio/modules/libgioremote-volume-monitor.so/                    |    131584 |   0
/lib/libuuid.so.1.3.0/                                                  |    131584 |   0
/usr/lib/libvorbisfile.so.3.3.2/                                        |    131584 |   0
/lib/libkrb5support.so.0.1/                                             |    131584 |   0
/usr/lib/libgvfscommon.so.0.0.0/                                        |    131584 |   0
/lib/librt-2.10.90.so/                                                  |    131584 |   0
/usr/lib/libavahi-common.so.3.5.1/                                      |    131584 |   0
/usr/lib/libnotify.so.1.1.3/                                            |    131584 |   0
/usr/lib/libavahi-glib.so.1.0.1/                                        |    131584 |   0
/usr/lib/gio/modules/libgvfsdbus.so/                                    |    131584 |   0
/usr/lib/libXcursor.so.1.0.2/                                           |    131584 |   0
/usr/lib/libXi.so.6.1.0/                                                |    131584 |   3
/usr/lib/libgailutil.so.18.0.1/                                         |    131584 |   0
/usr/lib/libXrender.so.1.3.0/                                           |    131584 |   0
/lib/libcap-ng.so.0.0.0/                                                |    131584 |   0
/usr/lib/libSM.so.6.0.0/                                                |    131584 |   0
/lib/libudev.so.0.4.2/                                                  |    131584 |   0
/lib/libgmodule-2.0.so.0.2200.2/                                        |    131584 |   0
/usr/lib/libXfixes.so.3.1.0/                                            |    131584 |   0
/lib/libgobject-2.0.so.0.2200.2/                                        |    131584 |   0
/usr/lib/libXrandr.so.2.2.0/                                            |    131584 |   1
/lib/libgio-2.0.so.0.2200.2/                                            |    131584 |   1
/lib/libpopt.so.0.0.0/                                                  |    131584 |   0
/lib/libz.so.1.2.3/                                                     |    131584 |   0
/usr/lib/libXext.so.6.4.0/                                              |    131584 |   0
/usr/lib/libpangocairo-1.0.so.0.2600.0/                                 |    131584 |   0
/usr/lib/libogg.so.0.6.0/                                               |    131584 |   0
/usr/lib/libcairo.so.2.10800.8/                                         |    131584 |   0
/usr/lib/libavahi-client.so.3.2.5/                                      |    131584 |   1
/usr/lib/libtdb.so.1.1.5/                                               |    131584 |   0
/usr/lib/libORBitCosNaming-2.so.0.1.0/                                  |    131584 |   0
/usr/lib/libstdc++.so.6.0.13/                                           |    131584 |   1
/lib/libgthread-2.0.so.0.2200.2/                                        |    131584 |   0
/lib/libgcc_s-4.4.1-20091008.so.1/                                      |    131584 |   0
/lib/libdbus-1.so.3.4.0/                                                |    131584 |   0
/usr/lib/libcanberra-gtk.so.0.1.4/                                      |    131584 |   0
/usr/lib/libpango-1.0.so.0.2600.0/                                      |    131584 |   0
/usr/lib/libpng12.so.0.39.0/                                            |    131584 |   0
/usr/lib/libltdl.so.7.2.0/                                              |    131584 |   0
/usr/lib/gtk-2.0/modules/libcanberra-gtk-module.so/                     |    131584 |   0
/lib/libnss_files-2.10.90.so/                                           |    131584 |   0
/lib/libcom_err.so.2.1/                                                 |    131584 |   0
/usr/lib/libcanberra.so.0.2.1/                                          |    131584 |   0
/usr/lib/libdbus-glib-1.so.2.1.0/                                       |    131584 |   0
/usr/lib/gtk-2.0/modules/libpk-gtk-module.so/                           |    131584 |   0
/usr/lib/libpixman-1.so.0.16.2/                                         |    131584 |   0
/usr/lib/libgdk_pixbuf-2.0.so.0.1800.2/                                 |    131584 |   0
/home/taras/.fontconfig/3830d5c3ddfd5cd38a049b759396e72e-x86.cache-2/   |    131072 |   0
/usr/lib/gconv/gconv-modules.cache/                                     |    131072 |   0
/home/taras/.mozilla/firefox/imph4tsg.default/xpti.dat/                 |    101060 |  14
/home/taras/firefox/greprefs.js/                                        |     74132 |  12
/home/taras/.mozilla/firefox/imph4tsg.default/urlclassifier3.sqlite/    |     65832 |  85
/home/taras/.mozilla/firefox/imph4tsg.default/places.sqlite/            |     53396 |  43
/home/taras/firefox/defaults/pref/firefox.js/                           |     40803 |  17
/usr/lib/gio/modules/libgiofam.so/                                      |     33280 |  13
/usr/lib/gio/modules/libgiogconf.so/                                    |     33280 |  13
/home/taras/firefox/libxpcom.so/                                        |     33280 |  13
/usr/lib/gconv/UTF-16.so/                                               |     33280 |  16
/usr/lib/libXss.so.1.0.0/                                               |     33280 |  14
/home/taras/firefox/libplc4.so/                                         |     33280 |   5
/home/taras/firefox/libplds4.so/                                        |     33280 |   0
/usr/share/X11/locale/locale.dir/                                       |     32768 |  16
/home/taras/firefox/run-mozilla.sh/                                     |     27368 |  12
/usr/share/icons/hicolor/index.theme/                                   |     24293 |  25
/home/taras/firefox/chrome/icons/default/default48.png/                 |     22164 |   1
/home/taras/.mozilla/firefox/imph4tsg.default/cert8.db/                 |     16644 |  13
/usr/share/icons/gnome/index.theme/                                     |     12657 |  41
/home/taras/firefox/chrome/icons/default/default32.png/                 |     11964 |   1
/home/taras/.mozilla/firefox/imph4tsg.default/search.json/              |     11392 |  14
/usr/share/themes/Clearlooks/gtk-2.0/gtkrc/                             |     11287 |  18
/etc/fonts/conf.avail/65-fonts-persian.conf/                            |      9880 |   1
/dev/urandom/                                                           |      8468 |   4
/home/taras/.mozilla/firefox/imph4tsg.default/secmod.db/                |      8452 |   1
/usr/share/icons/Bluecurve/cursors/xterm/                               |      8192 |  12
/usr/share/icons/Bluecurve/cursors/bottom_right_corner/                 |      8192 |   7
/etc/fonts/conf.avail/65-nonlatin.conf/                                 |      7706 |   0
/home/taras/firefox/firefox/                                            |      7695 |   0
/etc/fonts/fonts.conf/                                                  |      5325 |  17
/usr/share/locale/locale.alias/                                         |      5024 |   8
/usr/share/icons/Mist/index.theme/                                      |      4771 |   7
/home/taras/.mozilla/firefox/imph4tsg.default/key3.db/                  |      4356 |   1
/home/taras/firefox/chrome/icons/default/default16.png/                 |      4332 |  21
/usr/share/X11/locale/en_US.UTF-8/XLC_LOCALE/                           |      4287 |  12
/proc/meminfo/                                                          |      4096 |   0
/etc/fonts/conf.avail/30-metric-aliases.conf/                           |      3939 |   0
/etc/passwd/                                                            |      3766 |   0
/etc/gtk-2.0/i386-redhat-linux-gnu/gdk-pixbuf.loaders/                  |      3618 |  16
/etc/pango/i386-redhat-linux-gnu/pango.modules/                         |      3452 |  16
/home/taras/.mozilla/firefox/imph4tsg.default/content-prefs.sqlite/     |      3252 |   8
/etc/fonts/conf.avail/25-unhint-nonlatin.conf/                          |      2941 |  12
/etc/localtime/                                                         |      2899 |   0
/home/taras/.mozilla/firefox/imph4tsg.default/permissions.sqlite/       |      2228 |   3
/home/taras/.mozilla/firefox/imph4tsg.default/cookies.sqlite/           |      2212 |  15
/home/taras/firefox/application.ini/                                    |      2128 |  18
/etc/fonts/conf.avail/40-nonlatin.conf/                                 |      2069 |   0
/usr/share/fontconfig/conf.avail/57-dejavu-sans.conf/                   |      2011 |   0
/etc/fonts/conf.avail/45-latin.conf/                                    |      1837 |   0
/home/taras/.mozilla/firefox/imph4tsg.default/prefs.js/                 |      1827 |  29
/etc/nsswitch.conf/                                                     |      1734 |  20
/etc/fonts/conf.avail/60-latin.conf/                                    |      1701 |   0
/etc/fonts/conf.avail/90-synthetic.conf/                                |      1691 |   6
/usr/share/fontconfig/conf.avail/57-dejavu-serif.conf/                  |      1649 |   0
/lib/libdl-2.10.90.so/                                                  |      1536 |   0
/usr/share/fontconfig/conf.avail/57-dejavu-sans-mono.conf/              |      1509 |   1
/home/taras/firefox/chrome/toolkit.manifest/                            |      1418 |   8
/usr/share/fontconfig/conf.avail/65-google-droid-sans.conf/             |      1403 |   0
/home/taras/firefox/chrome/en-US.manifest/                              |      1251 |   0
/usr/share/fontconfig/conf.avail/25-ttf-arphic-uming-bitmaps.conf/      |      1221 |  10
/home/taras/firefox/defaults/pref/firefox-branding.js/                  |      1186 |  11
/etc/fonts/conf.avail/30-urw-aliases.conf/                              |      1164 |   0
/etc/fonts/conf.d/25-no-bitmap-fedora.conf/                             |      1160 |   0
/etc/fonts/conf.avail/20-unhint-small-vera.conf/                        |      1157 |   0
/home/taras/.mozilla/firefox/imph4tsg.default/formhistory.sqlite/       |      1156 |  14
/usr/share/icons/Fedora/index.theme/                                    |      1128 |  32
/usr/share/fontconfig/conf.avail/90-smc-fonts.conf/                     |      1094 |  15
/usr/share/fontconfig/conf.avail/41-ttf-arphic-uming.conf/              |      1043 |   0
/home/taras/firefox/chrome/browser.manifest/                            |       963 |   0
/usr/share/fontconfig/conf.avail/64-ttf-arphic-uming.conf/              |       951 |   0
/etc/fonts/conf.avail/20-fix-globaladvance.conf/                        |       912 |   0
/usr/share/fontconfig/conf.avail/20-unhint-small-dejavu-sans-mono.conf/ |       866 |  20
/home/taras/startup.html/                                               |       864 |  17
/usr/share/fontconfig/conf.avail/20-unhint-small-dejavu-serif.conf/     |       858 |   0
/usr/share/fontconfig/conf.avail/20-unhint-small-dejavu-sans.conf/      |       856 |   0
/home/taras/.mozilla/firefox/imph4tsg.default/localstore.rdf/           |       850 |  11
/home/taras/.mozilla/firefox/imph4tsg.default/sessionstore.js/          |       762 |  13
/usr/share/fontconfig/conf.avail/65-ipa-pgothic.conf/                   |       705 |   8
/lib/ld-2.10.90.so/                                                     |       704 |   0
/etc/fonts/conf.avail/69-unifont.conf/                                  |       672 |   0
/usr/share/fontconfig/conf.avail/75-ttf-arphic-ukai-select.conf/        |       611 |  22
/etc/gtk-2.0/i386-redhat-linux-gnu/gtk.immodules/                       |       598 |  11
/etc/fonts/conf.avail/49-sansserif.conf/                                |       545 |   0
/usr/share/fontconfig/conf.avail/90-ttf-arphic-uming-embolden.conf/     |       541 |  14
/usr/share/fontconfig/conf.avail/90-ttf-arphic-ukai-embolden.conf/      |       540 |   0
/lib/libselinux.so.1/                                                   |       512 |   0
/lib/libpthread-2.10.90.so/                                             |       512 |   0
/lib/libutil-2.10.90.so/                                                |       512 |   0
/lib/libm-2.10.90.so/                                                   |       512 |   0
/usr/share/fontconfig/conf.avail/66-lohit-kashmiri@devanagari.conf/     |       488 |   0
/usr/share/fontconfig/conf.avail/66-lohit-sindhi@devanagari.conf/       |       484 |   0
/usr/share/fontconfig/conf.avail/66-lohit-maithili.conf/                |       478 |   3
/usr/share/fontconfig/conf.avail/66-lohit-assamese.conf/                |       477 |  18
/usr/share/fontconfig/conf.avail/66-lohit-gujarati.conf/                |       477 |   9
/usr/share/fontconfig/conf.avail/66-lohit-konkani.conf/                 |       476 |  14
/usr/share/fontconfig/conf.avail/66-lohit-bengali.conf/                 |       475 |  15
/usr/share/fontconfig/conf.avail/66-lohit-marathi.conf/                 |       475 |   7
/usr/share/fontconfig/conf.avail/66-lohit-kannada.conf/                 |       475 |   0
/usr/share/fontconfig/conf.avail/66-lohit-punjabi.conf/                 |       475 |   0
/proc/cpuinfo/                                                          |       474 |   0
/usr/share/fontconfig/conf.avail/67-lohit-nepali.conf/                  |       473 |   0
/usr/share/fontconfig/conf.avail/66-lohit-telugu.conf/                  |       473 |   1
/usr/share/fontconfig/conf.avail/66-lohit-tamil.conf/                   |       471 |   0
/usr/share/fontconfig/conf.avail/66-lohit-hindi.conf/                   |       471 |   0
/usr/share/fontconfig/conf.avail/66-lohit-oriya.conf/                   |       471 |   0
/bin/bash/                                                              |       403 |   0
/usr/share/fontconfig/conf.avail/41-ttf-arphic-ukai.conf/               |       400 |   0
/etc/gnome-vfs-2.0/modules/default-modules.conf/                        |       399 |   6
/etc/fonts/conf.avail/80-delicious.conf/                                |       388 |   1
/usr/share/fontconfig/conf.avail/25-ttf-arphic-uming-render.conf/       |       362 |   0
/usr/share/fontconfig/conf.avail/25-ttf-arphic-ukai-render.conf/        |       361 |  18
/usr/share/fontconfig/conf.avail/35-ttf-arphic-uming-aliases.conf/      |       353 |   0
/usr/share/fontconfig/conf.avail/60-google-droid-sans-mono.conf/        |       345 |  16
/usr/share/fontconfig/conf.avail/35-ttf-arphic-ukai-aliases.conf/       |       343 |   1
/usr/share/fontconfig/conf.avail/61-stix.conf/                          |       332 |  10
/usr/share/fontconfig/conf.avail/59-google-droid-serif.conf/            |       329 |   4
/home/taras/firefox/defaults/pref/firefox-l10n.js/                      |       257 |   9
/etc/fonts/conf.avail/50-user.conf/                                     |       245 |   0
/home/taras/firefox/defaults/pref/reporter.js/                          |       205 |  16
/etc/fonts/conf.avail/51-local.conf/                                    |       189 |   0
/var/cache/fontconfig/0251a5afa6ac727a1e32b7d4d4aa7cf0-x86.cache-2/     |       160 |  15
/home/taras/.mozilla/firefox/imph4tsg.default/compatibility.ini/        |       159 |  15
/home/taras/.mozilla/firefox/imph4tsg.default/urlclassifierkey3.txt/    |       154 |  13
/etc/hosts/                                                             |       147 |  13
/home/taras/firefox/defaults/pref/channel-prefs.js/                     |       143 |   0
/etc/resolv.conf/                                                       |       134 |  10
/home/taras/firefox/platform.ini/                                       |       132 |   7
/usr/share/gvfs/remote-volume-monitors/hal.monitor/                     |       123 |   0
/usr/share/gvfs/remote-volume-monitors/gdu.monitor/                     |       123 |   7
/usr/share/gvfs/remote-volume-monitors/gphoto2.monitor/                 |       115 |  32
/home/taras/.mozilla/firefox/imph4tsg.default/extensions.ini/           |       112 |  12
/home/taras/.mozilla/firefox/imph4tsg.default/extensions.cache/         |       106 |  14
/etc/gtk-2.0/gtkrc/                                                     |        97 |  20
/home/taras/.mozilla/firefox/profiles.ini/                              |        94 |  21
/usr/share/themes/Default/gtk-2.0-key/gtkrc/                            |        82 |  20
/home/taras/firefox/chrome/pippki.manifest/                             |        69 |   0
/home/taras/firefox/browserconfig.properties/                           |        68 |  37
/home/taras/.Xauthority/                                                |        52 |  13
/var/lib/dbus/machine-id/                                               |        33 |  13
/etc/host.conf/                                                         |        26 |  13
/etc/gnome-vfs-2.0/modules/ssl-modules.conf/                            |        12 |   1
/home/taras/.mozilla/firefox/Crash Reports/InstallTime20091022031207/   |        10 |  22
/home/taras/.mozilla/firefox/Crash Reports/LastCrash/                   |        10 |   1
/home/taras/.mozilla/firefox/imph4tsg.default/cookies.sqlite-journal/   |         5 |   1
(263 rows)
</code></pre>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/10/20/large-apps-just-have-to-start-slow/">Rant on Library IO</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-10-20T14:24:36-07:00" pubdate data-updated="true">Oct 20<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>So I&#8217;ve been trying to figure out how optimize disk IO startup. I looked into IO caused by libraries and turns out that apps with big libraries are screwed. Here is how I came to this conclusion:</p>

<p>Gnomer&#8217;s <a href="http://www.gnome.org/~lcolitti/gnome-startup/analysis/">research</a> on startup pointed out that dumb readahead leads to wins in terms file io. So I wrote some code and sure enough, reading in libxul on top of our main() function does indeed result in a significant measurable speed-up on both Linux and OSX.</p>

<p>From the gnome page I found a link to some <a href="http://ds9a.nl/diskstat/">diskstat</a> stuff. There lay a presentation with graphs that appear to show that OpenOffice has a much better cold IO pattern than Firefox. Given that there are some strong similarities between our application layouts I went digging to see if OpenOffice does something funny. And oh boy, it does do <a href="http://wiki.services.openoffice.org/wiki/Performance/Reorder_Symbols_For_Libraries">funny</a> page reordering on Windows and &#8220;slightly-smarter-than-dumb-readahead-style library prefetch&#8221; on Linux&#8230;</p>

<p>So here is an innocent question: Why is page-reordering not done as a PGO step? I mean shouldn&#8217;t you fire up your app, feed some info back to the linker and be done with it? Another question: Why can&#8217;t we mark certain files as &#8220;keep this whole file in ram if someone asks for part of it to be paged in&#8221;?</p>

<p>So is the only way to fast application startup via static linking? It sure is easy to</p>

<p>posix_fadvise(open(argv[0],O_RDONLY),  POSIX_FADV_WILLNEED);</p>

<p>Are these hacks still the state of the art in making apps with large libraries startup fast?</p>

<p><strong>Update:</strong> Found some mentions of GNU Rope unfinishedware and a relatively recent blog <a href="http://blogs.linux.ie/caolan/2007/04/24/controlling-symbol-ordering/">post</a></p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/10/08/restless-bug-fixing/">Restless Bug Fixing</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-10-08T03:13:01-07:00" pubdate data-updated="true">Oct 8<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I spent the past couple weeks analyzing and improving fastload performance. I&#8217;ve long been suspicious of fastload, but only finally got around to investigating it in detail. I think there is some fundamentally ironic rule in software that if you put the word “fast” in the name of a component, it is bound to eventually become a performance bottleneck.</p>

<p>Almost a decade has passed since the conception of this code, so it was time to update code&#8217;s assumptions to reflect the capabilities of modern OSes. I landed the <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=412796">fix</a> today. It results in startup performance gains of 1-20% on various platforms I tested, making this the most exiting perf bug I&#8217;ve worked on.</p>

<p><strong>Plans</strong></p>

<p>Now that I&#8217;ve had my fill of almost a year&#8217;s worth of startup performance analysis, for the remainder of the year I plan to refocus on static analysis. My main goal is decent  C support on Dehydra(not to mention the ever elusive GCC 4.5 compatibility) and to facilitate a production-quality DXR.</p>

<p>I&#8217;m hoping that we&#8217;ll end up with cool ways of dealing with the painful/slow boilerplate (bugs <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=520626">520626</a>, <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=516085">516085</a> and <a href="https://bugzilla.mozilla.org/show_bug.cgi?id=517370">517370</a>)</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2009/09/30/corrupting-innocent-minds-with-gcc/">Corrupting Innocent Minds With GCC</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2009-09-30T10:32:38-07:00" pubdate data-updated="true">Sep 30<span>th</span>, 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Ever since the plugin branch landed in GCC, I have been itching to explore the application-specific optimization space that it opens up. It&#8217;s really hard to optimize code in the general case, but it&#8217;s relatively easy to optimize for something for specific use-cases. We can rely on API-specific static analysis in order to get rid of the API-imposed overheads at compile time. Let me repeat, we can get rid of some API-induced suck (OO frameworks  usually have a lot of it) without sacrificing any of the benefits.</p>

<p>Unfortunally, I got busy working on, supposedly, more important stuff such as making Firefox startup quicker, so my<a href="https://bugzilla.mozilla.org/show_bug.cgi?id=517370"> de-error-handling</a> and de-virtualizer (basically possible with LTO, but we can prove that certain classes will never be overloaded via dynamic linking) ideas had to be put on indefinite hold. Luckily, one of David Humphrey&#8217;s students decided to take on the first task, see his <a href="http://ehren.wordpress.com/2009/09/30/popping-my-gimples-a-plan/">blog post</a> here. I&#8217;m really psyched about this, few things that are cooler than cross-project open source work involving the most important open source projects of our time :)</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/blog/page/14/">&larr; Older</a>
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/12/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2012/11/26/coping-with-flash-hangs/">Coping with Flash hangs</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/11/16/snappy-44-fixing-tab-switching-in-vancouver/">Snappy #44: Fixing tab switching in Vancouver</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/11/05/snappy-43-big-improvements-faster-startup-smoother-tabstrip/">Snappy #43: Big improvements: faster startup? Smoother tabstrip!</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/10/26/snappy-42/">Snappy #42</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/10/18/snappy-41/">Snappy #41</a>
      </li>
    
  </ul>
</section>


<section>
  <h1>Latest Tweets</h1>
  <ul id="tweets">
    <li class="loading">Status updating&#8230;</li>
  </ul>
  <script type="text/javascript">
    $.domReady(function(){
      getTwitterFeed("tarasglek", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/tarasglek" class="twitter-follow-button" data-show-count="false">Follow @tarasglek</a>
  
</section>





  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2012 - Taras Glek -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'tarasglekblog';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
